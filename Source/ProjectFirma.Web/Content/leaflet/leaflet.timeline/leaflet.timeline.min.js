(function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={exports:{},id:r,loaded:!1};return n[r].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var i={};return t.m=n,t.c=i,t.p="",t(0)})([function(n,t,i){"use strict";L.TimelineVersion="1.0.0-beta";i(1);i(3);i(4)},function(n,t,i){"use strict";function e(n){return n&&n.__esModule?n:{"default":n}}var r=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),u=i(2),f=e(u);L.Timeline=L.GeoJSON.extend({times:[],ranges:null,initialize:function(n){var e=this,t=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],u;this.ranges=new f.default;var o=/^(\d+)(\.(\d+))?(\.(\d+))?(-(.*))?(\+(.*))?$/.exec(L.version),i=r(o,4),s=i[1],h=i[3];this.isOldVersion=parseInt(s,10)===0&&parseInt(h,10)<=7;u={drawOnSetTime:!0};L.GeoJSON.prototype.initialize.call(this,null,t);L.Util.setOptions(this,u);L.Util.setOptions(this,t);this.options.getInterval&&(this._getInterval=function(){var n;return(n=e.options).getInterval.apply(n,arguments)});n&&this._process(n)},_getInterval:function(n){return{start:new Date(n.properties.start).getTime(),end:new Date(n.properties.end).getTime()}},_process:function(n){var t=this,i=Infinity,r=-Infinity;(n.features.forEach(function(n){var u=t._getInterval(n);t.ranges.insert(u.start,u.end,n);t.times.push(u.start);t.times.push(u.end);i=Math.min(i,u.start);r=Math.max(r,u.end)}),this.start=this.options.start||i,this.end=this.options.end||r,this.time=this.start,this.times.length!==0)&&(this.times.sort(function(n,t){return n-t}),this.times=this.times.reduce(function(n,t,i){if(i===0)return n;var r=n[n.length-1];return r!==t&&n.push(t),n},[this.times[0]]))},setTime:function(n){this.time=typeof n=="number"?n:new Date(n).getTime();this.options.drawOnSetTime&&this.updateDisplayedLayers();this.fire("change")},updateDisplayedLayers:function(){for(var r,u,n,f,e=this,t=this.ranges.lookup(this.time),i=0;i<this.getLayers().length;i++){for(r=!1,u=this.getLayers()[i],n=0;n<t.length;n++)if(u.feature===t[n]){r=!0;t.splice(n,1);break}r||(f=this.getLayers()[i--],this.removeLayer(f))}t.forEach(function(n){return e.addData(n)})}});L.timeline=function(n,t){return new L.Timeline(n,t)}},function(n,t){"use strict";function u(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var r,i,e;Object.defineProperty(t,"__esModule",{value:!0});r=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}();i=function i(n,t,r,u){f(this,i);this.low=n;this.high=t;this.max=t;this.data=r;this.left=null;this.right=null;this.parent=u};e=function(){function n(){f(this,n);this._root=null;this.size=0}return r(n,[{key:"_insert",value:function(n,t,r,u,f,e){var o=void 0,s;return u===null?(o=new i(n,t,r,f),f===null?this._root=o:f[e]=o):(s=n<u.low||n===u.low&&t<u.high?"left":"right",o=this._insert(n,t,r,u[s],u,s),u.max=Math.max(u.max,o.max)),o}},{key:"insert",value:function(n,t,i){this._insert(n,t,i,this._root,this._root);this.size++}},{key:"lookup",value:function(n){var i=[],t=this._root;return(arguments.length===2&&(t=arguments[1]),t===null||t.max<n)?i:(i.push.apply(i,u(this.lookup(n,t.left))),t.low<=n&&(t.high>=n&&i.push(t.data),i.push.apply(i,u(this.lookup(n,t.right)))),i)}}]),n}();t.default=e},function(){"use strict";function t(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol?"symbol":typeof n};L.TimelineSliderControl=L.Control.extend({initialize:function(){var n=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],t={duration:1e4,enableKeyboardControls:!1,enablePlayback:!0,formatOutput:function(n){return""+(n||"")},showTicks:!0,waitToUpdateMap:!1,position:"bottomleft",steps:1e3};this.timelines=[];L.Util.setOptions(this,t);L.Util.setOptions(this,n);typeof n.start!="undefined"&&(this.start=n.start);typeof n.end!="undefined"&&(this.end=n.end)},_getTimes:function(){var u=this,i=[],r;return(this.timelines.forEach(function(n){var r=n.times.filter(function(n){return n>=u.start&&n<=u.end});i.push.apply(i,t(r))}),i.length&&(r=function(){i.sort(function(n,t){return n-t});var n=[i[0]];return i.reduce(function(t,i){return t!==i&&n.push(i),i}),{v:n}}(),(typeof r=="undefined"?"undefined":n(r))==="object"))?r.v:i},_recalculate:function(){var i=typeof this.options.start!="undefined",r=typeof this.options.end!="undefined",u=this.options.duration,n=Infinity,t=-Infinity;this.timelines.forEach(function(i){i.start<n&&(n=i.start);i.end>t&&(t=i.end)});i||(this.start=n,this._timeSlider.min=n===Infinity?0:n,this._timeSlider.value=this._timeSlider.min);r||(this.end=t,this._timeSlider.max=t===-Infinity?0:t);this._stepSize=Math.max(1,(this.end-this.start)/this.options.steps);this._stepDuration=Math.max(1,u/this.options.steps)},_nearestEventTime:function(n){for(var t,o,s,f=arguments.length<=1||arguments[1]===undefined?0:arguments[1],r=this._getTimes(),e=!1,i=r[0],u=1;u<r.length;u++){if(t=r[u],e)return t;if(t>=n){if(f===-1)return i;if(f===1)if(t===n)e=!0;else return t;else return o=Math.abs(n-i),s=Math.abs(n-t),o<s?i:t}i=t}return i},_createDOM:function(){var n=L.DomUtil.create("div","leaflet-control-layers leaflet-control-layers-expanded leaflet-timeline-control"),t,i;this.container=n;this.options.enablePlayback&&(t=L.DomUtil.create("div","sldr-ctrl-container",n),i=L.DomUtil.create("div","button-container",t),this._makeButtons(i),this.options.enableKeyboardControls&&this._addKeyListeners(),this._makeOutput(t));this._makeSlider(n);this.options.showTicks&&this._buildDataList(n)},_addKeyListeners:function(){var n=this;this._listener=function(){return n._onKeydown.apply(n,arguments)};document.addEventListener("keydown",this._listener)},_removeKeyListeners:function(){document.removeEventListener("keydown",this._listener)},_buildDataList:function(n){this._datalist=L.DomUtil.create("datalist","",n);var t=Math.floor(Math.random()*1e6);this._datalist.id="timeline-datalist-"+t;this._timeSlider.setAttribute("list",this._datalist.id);this._rebuildDataList()},_rebuildDataList:function(){for(var n=this._datalist,t;n.firstChild;)n.removeChild(n.firstChild);t=L.DomUtil.create("select","",this._datalist);this._getTimes().forEach(function(n){L.DomUtil.create("option","",t).value=n})},_makeButton:function(n,t){var r=this,i=L.DomUtil.create("button",t,n);i.addEventListener("click",function(){return r[t]()});L.DomEvent.disableClickPropagation(i)},_makeButtons:function(n){this._makeButton(n,"prev");this._makeButton(n,"play");this._makeButton(n,"pause");this._makeButton(n,"next")},_makeSlider:function(n){var i=this,t=L.DomUtil.create("input","time-slider",n);t.type="range";t.min=this.start||0;t.max=this.end||0;t.value=this.start||0;t.addEventListener("change",function(n){return i._sliderChanged(n)});t.addEventListener("input",function(n){return i._sliderChanged(n)});t.addEventListener("mousedown",function(){return i.map.dragging.disable()});document.addEventListener("mouseup",function(){return i.map.dragging.enable()});this._timeSlider=t},_makeOutput:function(n){this._output=L.DomUtil.create("output","time-text",n);this._output.innerHTML=this.options.formatOutput(this.start)},_onKeydown:function(n){switch(n.keyCode||n.which){case 37:this.prev();break;case 39:this.next();break;case 32:this.toggle();break;default:return}n.preventDefault()},_sliderChanged:function(n){var t=parseFloat(n.target.value,10);this.time=t;this.options.waitToUpdateMap&&n.type!=="change"||this.timelines.forEach(function(n){return n.setTime(t)});this._output&&(this._output.innerHTML=this.options.formatOutput(t))},addTimelines:function(){var t=this,i;this.pause();i=this.timelines.length;for(var r=arguments.length,u=Array(r),n=0;n<r;n++)u[n]=arguments[n];u.forEach(function(n){t.timelines.indexOf(n)===-1&&t.timelines.push(n)});this.timelines.length!==i&&(this._recalculate(),this.options.showTicks&&this._rebuildDataList(),this.setTime(this.start))},removeTimelines:function(){var t=this,i;this.pause();i=this.timelines.length;for(var r=arguments.length,u=Array(r),n=0;n<r;n++)u[n]=arguments[n];u.forEach(function(n){var i=t.timelines.indexOf(n);i!==-1&&t.timelines.splice(i,1)});this.timelines.length!==i&&(this._recalculate(),this.options.showTicks&&this._rebuildDataList(),this.setTime(this.start))},toggle:function(){this._playing?this.pause():this.play()},prev:function(){this.pause();var n=this._nearestEventTime(this.time,-1);this._timeSlider.value=n;this.setTime(n)},pause:function(){clearTimeout(this._timer);this._playing=!1;this.container.classList.remove("playing")},play:function(){var n=this;clearTimeout(this._timer);parseFloat(this._timeSlider.value,10)===this.end&&(this._timeSlider.value=this.start);this._timeSlider.value=parseFloat(this._timeSlider.value,10)+this._stepSize;this.setTime(this._timeSlider.value);parseFloat(this._timeSlider.value,10)===this.end?(this._playing=!1,this.container.classList.remove("playing")):(this._playing=!0,this.container.classList.add("playing"),this._timer=setTimeout(function(){return n.play()},this._stepDuration))},next:function(){this.pause();var n=this._nearestEventTime(this.time,1);this._timeSlider.value=n;this.setTime(n)},setTime:function(n){this._sliderChanged({type:"change",target:{value:n}})},onAdd:function(n){return this.map=n,this._createDOM(),this.setTime(this.start),this.container},onRemove:function(){this.options.enableKeyboardControls&&this._removeKeyListeners()}});L.timelineSliderControl=function(n,t,i,r){return new L.TimelineSliderControl(n,t,i,r)}},function(){}]);
//# sourceMappingURL=leaflet.timeline.min.js.map
